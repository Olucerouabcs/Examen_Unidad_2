<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crossy road</title>
    <style>
        canvas{
            background-color: white;
        }
        body{
            background-color:gray;
        }
    </style>
</head>
<body>
    <center>
        <canvas id="myCanvas" width="700" height="900" style="border:2px solid #000000;"></canvas>
    </center>
    <script>
        var canvas = document.getElementById('myCanvas'); 
        var ctx = canvas.getContext("2d");

        var mainX=0, mainY=0, vida=0;
        var pause=false;
        var dir, paso=30;
        console.log(canvas.width);

        //img.src = 'entrega-de-comida.png';
        //ctx.drawImage(img2, x2, y2, 100, 100); 

        var enBalsa = false;
        
        var si =true;

        function tablero(){
            ctx.fillStyle = "rgb(255,105,97)";
            ctx.fillRect(0, 0, 85, 900);

            ctx.fillStyle = "rgb(255,105,97)";
            ctx.fillRect(canvas.width-85, 0, 85, 900);

            ctx.font = "20px Arial";
            ctx.fillStyle = "black"; 
            ctx.fillText("Tiempo" , 10, 40)
            //Poner que funcione el tiempo
            ctx.fillText("00:00" , 10, 70)
            ctx.fillText("Nivel" , 10, 130)
            //Poner que funcione el contador de nivel
            ctx.fillText("0" , 60, 130)
        
            //Contador de vidas
            ctx.fillText("Vidas" , 10, 210)
            ctx.fillText("0" , 70, 210)
        }

        tablero();

        document.addEventListener("keydown", (e) => {
            console.log(e);
            switch (e.keyCode) {
        case 87:
            if (!pause) { 
                dir = 1;
                moveObjetos(0,paso);
                console.log("Arriba");
            }
            break;
        case 83:
            if (!pause) { 
                dir = 2;
                if(cesped.y<450){
                    moveObjetos(0,0);
                }else{
                    moveObjetos(0,-paso);
                    console.log("Abajo");
                }

            }
            break;
        case 68:
            if (!pause) { 
                dir = 3;
                if(jugador.x>550){
                    movePlayer(0,0);    
                }else{
                    movePlayer(paso,0);
                }

            }
            break;
        case 65:
            if (!pause) { 
                dir = 4;
                if(jugador.x<90){
                    movePlayer(0,0);    
                }else{
                    movePlayer(-paso,0);
                }
                console.log("x: "+jugador.x );
                console.log("izquierda");
            }
            break;
        case 32:
            pause = !pause;
            break;
        }

        });



        function repaint() {
            if(!pause){
                ctx.fillStyle = "white";
                ctx.fillRect(0, 0, 700, 900);

               if(coche.x==630 ){//|| si ==false
                coche.x =10;
                  //si=false;
                  console.log(si);
               }
               if(coche2.x==10 ){//|| si ==false
                coche2.x =630;
                  //si=false;
                  console.log(si);
               }
               //if(coche.x==85||si==true){
                coche2.x -=1;
                coche.x +=1; 
               // si=true;
               // console.log(si);
               //}

               repintarObjetos();
               jugador.dibujar();
               tablero()
               
            }else{
                ctx.fillStyle = "rgba(154,160,154,0.020)";
                ctx.fillRect(0, 0, 700, 900);

                ctx.font = "40px Arial";
                ctx.fillStyle = "black"; 
                ctx.fillText("p "+"a "+"u "+"s "+"a", 700/ 2 - 120, 900/ 2);
            }
        }

        function update() {
            if(pause==false){
                console.log("dir " + dir);

                switch (dir) {
                    case 1:
                        //cesped.y += paso;
                        break;
                    case 2:
                        //cesped.y -= paso;
                        break;
                    case 3:
                        //jugador.x += paso;

                        break;
                    case 4:
                        //jugador.x -= paso;

                        break;
                }
            }
            repaint();
            window.requestAnimationFrame(update);
        }

        window.requestAnimationFrame = (function () {
            return window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                function (callback) {
                    window.setTimeout(callback, 17);
                };
        }());

        window.requestAnimationFrame(update);



        class Jugador {
            constructor() {
                this.x = (canvas.width/2)-25; // Coordenada X inicial
                this.y = 600; // Coordenada Y inicial
                this.width = 50; // Ancho del cuadro
                this.height = 50; // Alto del cuadro
            }

            dibujar() {
                //ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpiar el lienzo
                ctx.fillStyle = 'black'; // Color del cuadro (en este caso, azul)
                ctx.fillRect(this.x, this.y, this.width, this.height); // Dibujar el cuadro
            }
        }

        // Crear una instancia de Jugador
        const jugador = new Jugador();

        // Dibujar el jugador en el lienzo
        jugador.dibujar();

        class Rio{
            constructor(dy) {
                this.x = 85; // Coordenada X inicial
                this.y = dy; // Coordenada Y inicial
                this.width = 530; // Ancho del cuadro
                this.height = 300; // Alto del cuadro
            }

            dibujar() {
                //ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpiar el lienzo
                ctx.fillStyle = 'blue'; // Color del cuadro (en este caso, azul)
                ctx.fillRect(this.x, this.y, this.width, this.height); // Dibujar el cuadro
            }

        }

        // Crear una instancia de Jugador
        const rio1 = new Rio(200);
        const rio2 = new Rio(-500);

        // Dibujar el Rio en el lienzo
        rio1.dibujar();
        rio2.dibujar();

        class Carretera{
            constructor(dy) {
                this.x = 85; // Coordenada X inicial
                this.y = dy; // Coordenada Y inicial
                this.width = 530; // Ancho del cuadro
                this.height = 300; // Alto del cuadro
            }

            dibujar() {
                //ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpiar el lienzo
                ctx.fillStyle = 'grey'; // Color del cuadro (en este caso, azul)
                ctx.fillRect(this.x, this.y, this.width, this.height); // Dibujar el cuadro
            }

        }

        // Crear una instancia de cesped
        const carretera = new Carretera(200);
        const carretera2 = new Carretera(-300);
        const carretera3 = new Carretera(-700);

        // Dibujar el carretera en el lienzo
        //carretera.dibujar();

        class Cesped{
            constructor(dy) {
                this.x = 85; // Coordenada X inicial
                this.y = dy; // Coordenada Y inicial
                this.width = 530; // Ancho del cuadro
                this.height = 500; // Alto del cuadro
            }

            dibujar() {
                //ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpiar el lienzo
                ctx.fillStyle = 'green'; // Color del cuadro (en este caso, azul)
                ctx.fillRect(this.x, this.y, this.width, this.height); // Dibujar el cuadro
            }

        }

        // Crear una instancia de cesped
        const cesped = new Cesped(400);
        const cesped2 = new Cesped(0);
        const cesped3 = new Cesped(-600);

        // Dibujar el cesped en el lienzo
        cesped.dibujar();
        
        class Coche{
            constructor(dy,dx) {
                this.x = dx; // Coordenada X inicial
                this.y = dy; // Coordenada Y inicial
                this.width = 100; // Ancho del cuadro
                this.height = 70; // Alto del cuadro
            }

            dibujar() {
                //ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpiar el lienzo
                ctx.fillStyle = 'yellow'; // Color del cuadro (en este caso, azul)
                ctx.fillRect(this.x, this.y, this.width, this.height); // Dibujar el cuadro
            }

        }

        const coche = new Coche(400,100);
        const coche2 = new Coche(230,630);

        coche.dibujar();

        function repintarObjetos(){
            //rio1.dibujar();
            //rio2.dibujar();
            cesped.dibujar();
            cesped2.dibujar();
            cesped3.dibujar();
            carretera.dibujar(); 
            carretera2.dibujar(); 
            carretera3.dibujar(); 
            coche.dibujar();
            coche2.dibujar();
        }


        function movePlayer(dx, dy) {
            if (!pause) {
                if (enBalsa) {
                    jugador.x += 1; // Mover al jugador horizontalmente con la balsa
                } else {
                    jugador.x += dx;
                    jugador.y += dy;
                }
                repaint();
            }
        }

        function moveObjetos(dx, dy) {
         // Mueve al jugador en la direcciÃ³n especificada (dx, dy)
         cesped.y += dy;
         cesped2.y += dy;
         cesped3.y += dy;

         rio1.y += dy;

         rio2.y += dy;

         carretera.y += dy;
         carretera2.y+= dy;
         carretera3.y+= dy;

         coche.y += dy;
         coche2.y += dy;
         
         repaint();
        }

    </script>
    
</body>
</html>